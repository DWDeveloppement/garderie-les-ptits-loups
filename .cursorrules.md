# ğŸ¯ RÃ¨gles Cursor - Garderie Les P'tits Loups

## ğŸ‡«ğŸ‡· Langue de communication
**IMPORTANT** : Tous les Ã©changes, code, commentaires et documentation doivent Ãªtre **en franÃ§ais**.

## ğŸ¤– Optimisation des modÃ¨les IA (Cursor)

Pour Ã©conomiser les tokens et optimiser les coÃ»ts, utilise le modÃ¨le appropriÃ© selon la complexitÃ© :

### SÃ©lection rapide du modÃ¨le

| TÃ¢che | ModÃ¨le Cursor | Autorisation |
|-------|---------------|--------------|
| ğŸ“ Documentation, typos, lecture | **Haiku 4.5** (gratuit) | âŒ Non |
| ğŸ§© Composants simples (Button, Card) | **Haiku 4.5** (gratuit) | âŒ Non |
| âš™ï¸ Formulaires, hooks, API | **Sonnet 4.5** (standard) | âŒ Non |
| ğŸ—ï¸ Architecture, refactoring majeur | **Opus 4.5** (cerveau) | âœ… **Demander** |

### RÃ¨gles d'utilisation

#### âœ… **Haiku 4.5** (sans logo cerveau - GRATUIT)
- Documentation (README, CLAUDE.md)
- Composants UI basiques
- Types TypeScript simples
- Corrections de formatage

#### âœ… **Sonnet 4.5** (logo standard - RECOMMANDÃ‰)
- Composants avec logique mÃ©tier
- Hooks personnalisÃ©s
- IntÃ©grations API (Sanity, Resend)
- Corrections de bugs moyens

#### âš ï¸ **Opus 4.5** (logo cerveau - SUR DEMANDE)
- Architecture systÃ¨me complexe
- Refactoring majeur
- Optimisations avancÃ©es
- **Toujours demander l'autorisation avant d'utiliser**

### Processus Opus

Si tu penses qu'Opus est nÃ©cessaire :

```
âš ï¸ Cette tÃ¢che nÃ©cessite Opus car :
- [Raison 1]
- [Raison 2]
Estimation : ~X tokens
Puis-je procÃ©der ?
```

**Attendre confirmation** avant de dÃ©marrer.

> ğŸ“– **Documentation complÃ¨te** : Voir [CLAUDE.md](./CLAUDE.md) pour tous les dÃ©tails

---

## Stack Technique
- **Framework** : Next.js 15 + TypeScript + Tailwind CSS v4
- **UI** : Radix UI primitives + Radix Theme
- **Palette** : Orange (neutre) + Purple (accent)
- **CMS** : Sanity
- **Email** : Resend

## Scripts de DÃ©veloppement
- **Dev** : `npm run dev` (port 3000)
- **Build** : `npm run build`
- **Start** : `npm run start` (port 3100)
- **Start Dev** : `npm run start:dev` (port 3000)
- **Sanity** : `npm run sanity` (studio CMS)
- **Clean** : `npm run clean` (supprime .next)
- **Refresh** : `npm run refresh` (clean + dev)
- **Review** : `npm run review` (clean + build + start)

## Installation Radix Theme
```bash
npm install @radix-ui/themes
```

## Structure du Projet
```
src/
â”œâ”€â”€ app/              # Pages Next.js (routing)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/           # Composants Radix Theme purs
â”‚   â”œâ”€â”€ shared/       # Composants custom rÃ©utilisables
â”‚   â”œâ”€â”€ pages/        # Sections de pages (Hero, Contact, etc.)
â”‚   â””â”€â”€ examples/     # Composants d'exemple
â”œâ”€â”€ hooks/            # Hooks personnalisÃ©s
â”œâ”€â”€ lib/              # Utilitaires (utils.ts, theme-utils.ts)
â”œâ”€â”€ styles/           # CSS (palette.css)
â””â”€â”€ types/            # Types TypeScript
```

## Conventions de Code
- **TypeScript** : Strict, `type` au lieu d'`interface`
- **Nommage** : PascalCase composants, camelCase fonctions
- **Styles** : Tailwind CSS avec palette Orange/Purple
- **Commentaires** : En franÃ§ais

## Palette de Couleurs
- **Purple** : Accent (boutons, liens) - `accentColor="purple"`
- **Orange** : Neutre (backgrounds, borders) - `grayColor="gray"` (Orange custom)
- **Usage** : `bg-purple-9`, `text-gray-11`, `border-gray-6`
- **SimplicitÃ©** : Pas de display-p3, Ã©chelle OKLCH simple

## Composants Existants
- **ui/** : Button, Card, Toast (Radix Theme purs)
- **shared/** : BackToTop, MobileNavigation, StaticMap, DynamicMap, BottomBar (Toolbar), etc.
- **ContactForm** : Validation, localStorage, reCAPTCHA
- **Maps** : OpenStreetMap + Leaflet (pas Google Maps)
- **Navigation** : Mobile bottom bar avec auto-hide (Radix Toolbar)

## Migration Shadcn â†’ Radix Theme
- **Remplacer** progressivement les composants Shadcn
- **Utiliser** les variants Radix natifs
- **Ã‰viter** les conflits de styles
- **Maintenir** la cohÃ©rence visuelle

## Approche Couleurs
- **Radix Theme** : `accentColor="purple"`, `grayColor="gray"` (Orange custom)
- **Orange comme gray** : Variables CSS `--gray-*` dans `globals.css`
- **Utilitaires** : `src/lib/theme-utils.ts` pour la configuration
- **SimplicitÃ©** : Une seule Ã©chelle de couleurs, pas de display-p3

## RÃ¨gles de DÃ©veloppement
1. **Utiliser** les composants existants
2. **Respecter** la palette Orange/Purple
3. **CrÃ©er** des composants modulaires
4. **PrivilÃ©gier** la simplicitÃ© et la maintenabilitÃ©
5. **Radix Theme uniquement** : Pas de mÃ©lange avec Shadcn UI
6. **Variants Radix** : Utiliser les variants natifs (color, size, variant)
7. **CohÃ©rence** : Garder une approche unifiÃ©e pour les styles

## ğŸ¯ StratÃ©gie Design Solutions

### Approche Hybride Radix + HTML/Tailwind
**Principe** : Utiliser le meilleur des deux mondes selon le contexte

#### âœ… **Utiliser Radix Theme quand :**
- **Interactions** : Hover, focus, Ã©tats actifs
- **AccessibilitÃ©** : Composants complexes (forms, modals, dropdowns)
- **FonctionnalitÃ©s** : Props Radix utiles (color, size, variant)
- **CohÃ©rence** : Design system uniforme

**Exemples** : Button, Card avec hover, Form components, Toast

#### âš¡ **Utiliser HTML/Tailwind brut quand :**
- **Conflits CSS** : Radix Ã©crase les styles (display, flex, grid)
- **Performance** : Composants simples sans interactions
- **ContrÃ´le total** : Layout complexe, positioning prÃ©cis
- **Bundle size** : Ã‰viter le JavaScript Radix inutile

**Exemples** : DynamicMap (div brut), Layout containers, Static elements

### ğŸ”§ **ImplÃ©mentation Pratique**

#### **Composants Radix (avec classes de base)**
```tsx
// card.tsx
const CARD_BASE_CLASSES = 'rounded-lg overflow-hidden border p-0'

const Card = ({ children, ...props }) => (
  <RadixCard className={`${CARD_BASE_CLASSES} ${props.className || ''}`}>
    {children}
  </RadixCard>
)
```

#### **Composants HTML/Tailwind (pour cas spÃ©ciaux)**
```tsx
// DynamicMap.tsx
<div className='relative rounded-lg overflow-hidden border border-orange-6 p-0'>
  {/* Contenu sans conflits CSS */}
</div>
```

### ğŸ“‹ **DÃ©cision Tree**
1. **Besoin d'interactions ?** â†’ Radix Theme
2. **Conflits CSS Radix ?** â†’ HTML/Tailwind brut
3. **Composant simple ?** â†’ HTML/Tailwind brut
4. **AccessibilitÃ© complexe ?** â†’ Radix Theme
5. **Performance critique ?** â†’ HTML/Tailwind brut

### ğŸ¨ **Avantages de cette approche**
- âœ… **FlexibilitÃ©** : Solution adaptÃ©e au contexte
- âœ… **Performance** : Pas de JavaScript inutile
- âœ… **MaintenabilitÃ©** : Code prÃ©visible et dÃ©bogable
- âœ… **Ã‰volutivitÃ©** : Migration progressive possible
- âœ… **ProductivitÃ©** : Pas de lutte contre les conflits CSS

## Backend Sanity

### ğŸ¯ Approche mÃ©thodologique
1. **Versioning** : VÃ©rifier la compatibilitÃ© Sanity v3 vs v2
2. **Configuration** : Plugins et structure dans l'ordre des prioritÃ©s
3. **Types** : DÃ©finir les schÃ©mas avant l'implÃ©mentation
4. **Validation** : Tests en local avant dÃ©ploiement

### ğŸ“Š PrioritÃ©s dÃ©veloppement Sanity

#### **Phase 1 : Fondations**
1. **Structure des types** : Pages, structures, espaces, prix, subventions
2. **Configuration de base** : Studio, plugins essentiels, structure de navigation
3. **Types TypeScript** : GÃ©nÃ©ration automatique des types depuis les schÃ©mas

#### **Phase 2 : Contenu**
4. **Gestion des mÃ©dias** : Upload, optimisation, rÃ©fÃ©rences
5. **Validation des champs** : Obligatoires pour SEO et cohÃ©rence
6. **Rich Text** : Ã‰diteur avec composants personnalisÃ©s (callout, blockquote)

#### **Phase 3 : FonctionnalitÃ©s avancÃ©es**
7. **Pages Ã  slug** : Structure pour contenu dynamique
8. **PrÃ©visualisation** : Live preview avec Next.js
9. **RequÃªtes GROQ** : Optimisation et cache

#### **Phase 4 : Finalisation**
10. **ThÃ¨me personnalisÃ©** : Interface utilisateur (optionnel)
11. **DÃ©ploiement** : Production et monitoring

### ğŸ”§ RÃ¨gles techniques

- **DRY** : RÃ©utiliser les champs communs (`fields/`)
- **SÃ©paration** : Champs vs Composants (`components/`)
- **Nommage** : `*Field` pour champs, `*Object` pour composants
- **Exports** : Centraliser avec `index.ts`

### âš ï¸ Points d'attention

- **Migration v2â†’v3** : `deskTool` â†’ `structureTool`
- **Performance** : Limiter les requÃªtes GROQ complexes
- **SEO** : MÃ©tadonnÃ©es obligatoires sur toutes les pages
- **AccessibilitÃ©** : Alt text obligatoire pour toutes les images

**Contexte actuel :** Migration Sanity v2â†’v3, problÃ¨me "Structure"â†’"Contenu", prÃ©paration pages Ã  slug

## Commandes Utiles

### Commandes Ã  privilÃ©gier (plus lent mais plus sÃ»r)
- **DÃ©veloppement** : `npm run refresh` (netoyage de cache et port 3000)
- **Production en local** : `npm run review` (netoyage de cache et port 3100)

### Commandes dÃ©taillÃ©es
- **DÃ©veloppement** : `npm run dev` (port 3000)
- **Production** : `npm run start` (port 3100)
- **Nettoyage** : `npm run clean` puis `npm run refresh`
- **Sanity Studio** : `npm run sanity`
- **Test complet** : `npm run review`
